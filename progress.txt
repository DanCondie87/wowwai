# Progress Log

## US-001: Project Scaffolding [DONE]
- Next.js 16 + TypeScript + Tailwind CSS v4 + shadcn/ui already set up
- Created missing directories: convex/, scripts/, docs/, src/hooks/
- Created app route directories: board/, workflows/, analytics/, my-work/, settings/
- 14 shadcn/ui components pre-installed
- .gitignore updated with .convex/ exclusion
- Note: Convex not yet initialized (no npx convex dev) — will deploy later
- CLAUDE.md already in place with full project conventions

## US-002: Tokenized Theme System [DONE]
- CSS variables already configured in globals.css (OKLch color model, light + dark)
- Created ThemeProvider component wrapping next-themes
- Created ThemeToggle component (sun/moon icon, shadcn Button)
- Updated layout.tsx: ThemeProvider with attribute="class", defaultTheme="system", enableSystem
- Added suppressHydrationWarning to <html> for next-themes compatibility
- Replaced boilerplate page.tsx with WOWWAI landing + theme toggle
- Typecheck passes

## US-004: Convex Schema — Projects & Ideas [DONE]
- Created convex/schema.ts with projects and ideas tables
- Projects: name, slug, description, status (active/archived), color, createdAt
- Ideas: projectId (optional), title, description, tags, status, source, createdAt
- Indexes: projects by_status, ideas by_projectId and by_status
- Created _generated stubs (dataModel, server, api) for typecheck without Convex init
- Typecheck passes

## US-005: Convex Schema — Tasks & Audit Logs [DONE]
- Tasks table: full spec with projectId, parentTaskId, cardId, status union, assignee, priority, tags, blockedBy array, position, timestamps
- AuditLogs table: taskId, actor union, action, before/after, comment, modelUsed, timestamp
- Indexes: tasks by_projectId, by_status, by_assignee, by_parentTaskId; auditLogs by_taskId
- Typecheck passes

## US-006: Convex Schema — Workflows, File Sync, Agent Activity [DONE]
- workflowTemplates: name, description, sourceFile, createdAt
- workflowSteps: templateId, name, description, order, loop fields, references array, model/agent info
- fileVersions: filePath, content, editedBy, editedVia, snapshotName, timestamp (indexed by_filePath)
- fileSyncQueue: filePath, content, direction, status, timestamp (indexed by_status, by_filePath)
- agentActivity: taskId, sessionKey, model, status, currentAction, timestamps (indexed by_taskId, by_sessionKey, by_status)
- Typecheck passes

## US-007: Project CRUD Mutations & Queries [DONE]
- create: takes name, color, description; auto-generates slug via slugify()
- update: takes id + optional name/slug/color/description; auto-regenerates slug when name changes
- archive: sets status to "archived"
- getAll: returns active projects using by_status index
- getById: returns single project by id
- Typecheck passes

## US-008: Task CRUD Mutations & Queries [DONE]
- create: auto-generates cardId as {SLUG}-{N}, sets position to max+1 in column
- update: diffs fields, creates audit log entry per changed field
- moveToColumn: updates status + position, sets completedAt when moving to "done"
- reorder: updates position within same column
- getByProject: sorted by status then position
- getByStatus: returns all tasks across projects for a given status
- getById: returns task + subtasks (child tasks via parentTaskId)
- All mutations create audit log entries inline (same transaction)
- Typecheck passes

## US-009: Audit Log Mutations & Queries [DONE]
- create mutation: public-facing, takes taskId, actor, action, before/after, comment, modelUsed
- createInternal: internal mutation for use by other Convex functions
- getByTask query: returns logs for a task, sorted by timestamp descending
- Task mutations (US-008) inline audit log creation for status changes, field updates, moves
- Typecheck passes

## US-003: Clerk Authentication [DONE]
- ConvexProvider wraps the app in layout.tsx (dev mode without Clerk keys)
- TODO comments mark where ConvexProviderWithClerk + ClerkProvider go
- middleware.ts stub created (no-op, passes all requests through)
- Sign-in page at /sign-in with placeholder (ready for Clerk <SignIn />)
- Sign-up page at /sign-up with placeholder (ready for Clerk <SignUp />)
- Auth routes under (auth) route group
- Typecheck passes

## US-010: App Layout Shell [DONE]
- AppLayout component: header + collapsible sidebar + main content
- AppHeader: WOWWAI logo, theme toggle, user button placeholder, hamburger on mobile
- AppSidebar: Board, Workflows, My Work nav links with active state
- Mobile: sidebar hidden by default, opens with overlay on hamburger click
- Desktop: sidebar always visible, static positioning
- (app) route group wraps board/workflows/my-work/settings/analytics
- Root page redirects to /board
- Placeholder pages for workflows, my-work, settings, analytics
- Typecheck passes

## US-011: Kanban Board — Column Layout [DONE]
- Board page at /board with 5 task status columns: Backlog, To Do, In Progress, Review, Done
- KanbanBoard component: project filter dropdown, mobile column tabs, desktop horizontal scroll
- KanbanColumn component: header with name + count, scrollable card list, "+" add button
- Mobile: tab navigation to switch between columns (one at a time)
- Desktop: all columns visible side-by-side with horizontal scroll
- Empty state: "No tasks yet" message per column
- Added tasks.getAll query to convex/tasks.ts
- Column definitions in lib/columns.ts
- Typecheck passes

## US-012: Task Card Component [DONE]
- Project color strip (3px left border)
- Card ID in muted text, title bold
- Assignee avatar: shark emoji for dali, person for dan
- Priority dot: green/blue/orange/red for low/medium/high/urgent
- Tags as pills (max 3 visible, +N overflow)
- Subtask progress bar with fraction text
- BLOCKED badge (destructive variant) when blockedBy is non-empty
- Staleness indicator: green <24h, yellow 1-3d, orange 3-7d, red >7d
- Hover elevation, focus-visible ring
- Columns only show top-level tasks (filter out subtasks)
- Typecheck passes

## US-013: Drag and Drop Between Columns [DONE]
- DndContext wraps the board with PointerSensor + TouchSensor
- SortableContext + useSortable for card dragging within/between columns
- useDroppable on columns for cross-column drop targets
- DragOverlay shows ghost card during drag
- Touch-friendly: 200ms delay activation for mobile long-press
- Column highlights with ring-2 when hovered during drag
- handleDragEnd calls moveToColumn for cross-column moves, reorder for same-column
- Board page wired up with onAddTask and onCardClick callbacks
- Stub components created for CreateTaskDialog and CardDetailSheet
- Typecheck passes

## Learnings
- Convex 1.31 uses *Generic pattern (mutationGeneric, queryGeneric) not *Builder
- _generated stubs must use typeof import("convex/server").mutationGeneric for type compat
- Audit logs created inline via ctx.db.insert in same transaction as task mutations

---
